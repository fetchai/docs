import { CodeGroup, CodeSegment, DocsCode, GithubCodeSegment } from "../../../../components/code";

# Using agents storage function

## Introduction

In this guide, we want to illustrate how storage functions are called and how to use them. We want to create an agent which gets a value from the storage (starting from 0) every second. Then prints it, and puts the new value back into the storage but increased by 1 unit.

## Prerequisites

Make sure you have read the following resources before going on with this guide:

   - [Creating your first agent ↗️](/guides/agents/getting-started/create-a-uagent)
   - [Agent Handlers ↗️](/guides/agents/intermediate/handlers)

## Imports needed

   - [uAgents ↗️](https://pypi.org/project/uagents/)

## Walk-through

1. To start let's create a Python script and name it `storage.py`, we can do this in terminal with the following command:

   <CodeGroup hasCopy isOSFile>
   <DocsCode mac={true}>
      ```py copy filename="mac"
      touch storage.py
      ```
   </DocsCode>

   <DocsCode windows={true}>
       ```py copy filename="windows"
       echo. > storage.py
       ```
   </DocsCode>

   <DocsCode ubuntu={true}>
       ```py copy filename="ubuntu"
       touch storage.py
       ```
   </DocsCode>
   </CodeGroup>

2. Then, we need to open the script in the text editor of choice and import the necessary classes, `Agent` and `Context`, from the `uagents` library.

3. Let's then create an agent named `alice` which logs a message every second using the `.on_interval()` decorator, indicating the current count. The `on_interval()` function takes a `Context` object as a parameter: the `Context` object contains a `storage` attribute, which is used to store and retrieve data between method calls:

<GithubCodeSegment digest="a20a1b5aa1aa22ff7fc48061558b3568">
    <CodeSegment
        path="https://github.com/fetchai/uAgent-Examples/blob/main/5-documentation/guides/agents/intermediate/storage-function/storage.py"
        lineStart={1}
        lineEnd={14}
        hosted={true}
    />
</GithubCodeSegment>
<CodeGroup dynamic hasCopy isLocalHostedFile digest='a20a1b5aa1aa22ff7fc48061558b3568'>

<DocsCode local={true}>
	```py copy filename="storage.py"

	from uagents import Agent, Context
	
	alice = Agent(name="alice", seed="alice recovery phrase")
	
	@alice.on_interval(period=1.0)
	async def on_interval(ctx: Context):
	    current_count = ctx.storage.get("count") or 0
	
	    ctx.logger.info(f"My count is: {current_count}")
	
	    ctx.storage.set("count", current_count + 1)
	
	if __name__ == "__main__":
	    alice.run()

```
</DocsCode>

</CodeGroup>



   Here, the `on_interval()` function retrieves the current count from the storage attribute using the `ctx.storage.get()` method. It prints the `current_count` value, and then increments it by `1`, and stores the updated count back to the storage attribute using the `ctx.storage.set()` method. The current count is then logged using the `ctx.logger.info()` method.

4. Save the script.

## Run the script

On your terminal, make sure you activated the virtual environment.

Run the script: `python storage.py`

The output should look as follows:

    ```
    WARNING:  [alice]: No endpoints provided. Skipping registration: Agent won't be reachable.
    INFO:     [alice]: My count is: 0
    INFO:     [alice]: Agent inspector available at https://agentverse.ai/inspect/?uri=http%3A//127.0.0.1%3A8000&address=agent1qww3ju3h6kfcuqf54gkghvt2pqe8qp97a7nzm2vp8plfxflc0epzcjsv79t
    INFO:     [alice]: Starting server on http://0.0.0.0:8000 (Press CTRL+C to quit)
    INFO:     [alice]: My count is: 1
    INFO:     [alice]: My count is: 2
    INFO:     [alice]: My count is: 3
    ...
    ```
